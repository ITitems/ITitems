<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="approvalManageDAO">

	<resultMap type="egovframework.let.aprv.service.ApprovalManageVO" id="ApprovalList">
		<result property="reqId" column="REQ_ID"/>
		<result property="id" column="ID"/>
		<result property="prjId" column="PRJ_ID"/>
		<result property="pm" column="PM"/>
		<result property="startDate" column="START_DATE"/>
		<result property="endDate" column="END_DATE"/>
		<result property="place" column="PLACE"/>
		<result property="reqDate" column="REQ_DATE"/>
		<result property="reqGroup" column="REQ_GROUP"/>
		<result property="reqStatus" column="REQ_STATUS"/>
	</resultMap>

	<select id="selectApprovalList" parameterType="egovframework.let.aprv.service.ApprovalDefaultVO" resultMap="ApprovalList">
		 SELECT R.REQ_ID,
			    R.ID,
			    R.PRJ_ID,
			    R.PM,
			    DATE_FORMAT(R.START_DATE,'%Y %m %d'),
			    DATE_FORMAT(R.END_DATE,'%Y %m %d'),
			    R.PLACE,
			    DATE_FORMAT(R.REQ_DATE,'%Y %m %d'),
			    R.REQ_GROUP,
			    R.REQ_STATUS,
			    A.TARGET_ID
		   FROM REQUESTS R LEFT JOIN APRVTARGET A
		     ON R.REQ_ID = A.REQ_ID
		  <!--  WHERE A.TARGET_ID = #{uniqId} -->
	   ORDER BY R.REQ_DATE
	</select>
	
	<select id="selectApprovalListTotCnt" parameterType="egovframework.let.aprv.service.ApprovalDefaultVO" resultType="java.util.HashMap">
		SELECT COUNT(R.REQ_ID) totcnt
		  FROM REQUESTS R 
	 LEFT JOIN APRVTARGET A
		    ON R.REQ_ID = A.REQ_ID
		<!-- WHERE A.TARGET_ID = #{uniqId} --> 
	</select>

</mapper>