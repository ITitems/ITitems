<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="AssetHistDAO">

	<resultMap type="egovframework.let.ass.service.AssetHistVO"
		id="AssetHistList">
		<result property="rum" column="RUM" />
		<result property="assetId" column="ASSET_ID" />
		<result property="largeCategory" column="LARGE_CATEGORY" />
		<result property="middleCategory" column="MIDDLE_CATEGORY" />
		<result property="assetName" column="ASSET_NAME" />
		<result property="histQty" column="HIST_QTY" />
		<result property="acquiredDate" column="ACQUIRED_DATE" />
		<result property="acquiredPrice" column="ACQUIRED_PRICE" />
		<result property="maker" column="MAKER" />
		<result property="histStatus" column="HIST_STATUS" />
	</resultMap>

	<resultMap type="egovframework.let.ass.service.AssetHistVO"
		id="AssetHistDetail">
		<result property="" column="" />
	</resultMap>


	<select id="SelectAssetHistVOList"
		parameterType="egovframework.let.ass.service.AssetManageVO"
		resultMap="AssetHistList">
		
	</select>

	<select id="CountAssetHistVOList"
		parameterType="egovframework.let.ass.service.AssetManageVO"
		resultType="int">

	</select>

	<insert id="InsertAssetHist"
		parameterType="egovframework.let.ass.service.AssetHistVO">
		
		<selectKey resultType="String" keyProperty="histId" order="BEFORE">
			SELECT 
			    CONCAT('ASH',IFNULL(MAX(SUBSTR(HIST_ID,4))+1,0)) 
			FROM ASSETSHIST
		</selectKey>
		
		INSERT INTO ASSETSHIST
		      (   HIST_ID, 
		          ASSET_ID, 
		          ORGNZT_ID, 
		          PRJ_ID, 
		          USE_ID, 
		          HIST_QTY, 
		          HIST_STATUS, 
		          HIST_NOTE, 
		          HIST_DATE, 
		          RCPT_DATE, 
		          RCPT_ID, 
		          CARRY_REASON, 
		          APPROVAL, 
		          CODE, 
		          FILE_ID )
		VALUES (
		          #{histId}, 
		          #{assetId}, 
		          #{orgnztId}, 
		          #{prjId}, 
		          #{useId}, 
		          #{histQty}, 
		          #{histStatus},
		          #{histNote},
		          DATE_FORMAT(CURRENT_DATE, '%Y-%m-%d %H:%i:%s'), 
		          DATE_FORMAT(#{rcptDate}, '%Y-%m-%d'), 
		          #{rcptId}, 
		          #{carryReason}, 
		          #{approval},
		          #{code}, 
		          #{fileId})
	</insert>

</mapper>